const emailInput=document.getElementById("email"),emailFeedback=document.querySelector(".email-feedback"),emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;emailInput.addEventListener("input",function(){const e=this.value.trim();""===e?(emailInput.classList.remove("email-valid","email-invalid"),emailFeedback.textContent=""):emailRegex.test(e)?(emailInput.classList.remove("email-invalid"),emailInput.classList.add("email-valid"),emailFeedback.innerHTML='<span class="email-valid-text">✓ Email valid</span>'):(emailInput.classList.remove("email-valid"),emailInput.classList.add("email-invalid"),emailFeedback.innerHTML='<span class="email-invalid-text">✗ Email tidak valid</span>')});const waInput=document.getElementById("wa");waInput.addEventListener("input",function(){let e=this.value.replace(/\D/g,"");e.startsWith("0")&&(e="62"+e.substring(1)),e&&!e.startsWith("62")&&(e="62"+e),this.value=e});const scriptURL="https://script.google.com/macros/s/AKfycbz011yVO2MS8cUxgURoqq7-84ZDpcpSMRefRTE2rXSl0lmEiRltQBNoyxbox1Ww_RtD2g/exec",form=document.getElementById("daftarForm"),submitBtn=form.querySelector('button[type="submit"]'),originalBtnText=submitBtn.innerHTML,preventCloseHandler=e=>(e.preventDefault(),e.returnValue="","");form.addEventListener("submit",e=>{e.preventDefault(),window.addEventListener("beforeunload",preventCloseHandler),Swal.fire({title:"Mengirim Data Pendaftaran",html:'<div style="font-size: 16px; margin: 20px 0;"><p>Sedang mengirim data pendaftaran Anda...</p><p style="color: #ef4444; font-weight: bold; margin-top: 15px;">⚠️ Jangan tutup browser!</p></div>',icon:"warning",allowOutsideClick:!1,allowEscapeKey:!1,didOpen:async()=>{Swal.showLoading()}});const t=new FormData(form);fetch(scriptURL,{method:"POST",body:t}).then(e=>e.json()).then(e=>{console.log(e),window.removeEventListener("beforeunload",preventCloseHandler),"success"===e.status?Swal.fire({icon:"success",title:"Berhasil!",text:e.message||"Pendaftaran berhasil! Terima kasih telah bergabung dengan kami.",confirmButtonText:"OK",confirmButtonColor:"#2563eb"}).then(()=>{form.reset()}):Swal.fire({icon:"error",title:"Gagal!",text:e.message||"Terjadi kesalahan saat mendaftar",confirmButtonText:"Coba Lagi",confirmButtonColor:"#ef4444"})}).catch(e=>{console.error("Gagal:",e),window.removeEventListener("beforeunload",preventCloseHandler),Swal.fire({icon:"error",title:"Error!",text:"Gagal kirim data: "+e.message,confirmButtonText:"Coba Lagi",confirmButtonColor:"#ef4444"})})});